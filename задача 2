using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace задача_комплексные
{
    

    struct Complex
    {
        public double Re;
        public double Im;


        public Complex(double re, double im)
        {
            Re = re;
            Im = im;
        }

        public  Complex Add(Complex other)
        {
            return new Complex(Re + other.Re, Im + other.Im);
        }

        public Complex Raz(Complex other)
        {
            return new Complex(Re - other.Re, Im - other.Im);
        }

        public Complex Mul(Complex other)
        {
            return new Complex(Re * other.Re - Im * other.Im,
                               Re * other.Im + Im * other.Re);
        }

        public Complex Div(Complex other)
        {
            double temp = other.Re * other.Re + other.Im * other.Im;
            return new Complex((Re * other.Re + Im * other.Im) / temp,
                               (Im * other.Re - Re * other.Im) / temp);
        }

        public double Abs()
        {
            return Math.Sqrt(Re * Re + Im * Im);
        }

        public double Arg()
        {
            return Math.Atan2(Im, Re);
        }

        

        public override string ToString()
        {
            return $"{Re} {(Im >= 0 ? "+" : "-")} {Math.Abs(Im)}i";
        }
    }

    class Program
    {
        static void Main()
        {
            Complex num = new Complex(0, 0);
            while (true)
            {
                Console.WriteLine("Текущее число: " + num);
                Console.WriteLine("Выберите действие:");
                Console.WriteLine("1  Ввести новое число");
                Console.WriteLine("2  Сложить");
                Console.WriteLine("3  Вычесть");
                Console.WriteLine("4  Умножить");
                Console.WriteLine("5  Разделить");
                Console.WriteLine("6  Найти модуль");
                Console.WriteLine("7  Найти аргумент");
                Console.WriteLine("Q  Выход");
                

                string vibor = Console.ReadLine();
                Console.WriteLine();

                switch (vibor)
                {
                    case "1":
                        Console.Write("Введите Re: ");
                        double re = double.Parse(Console.ReadLine());
                        Console.Write("Введите Im: ");
                        double im = double.Parse(Console.ReadLine());
                        num = new Complex(re, im);
                        break;

                    case "2":
                        Complex add = InputComplex();
                        num = num.Add(add);
                        break;

                    case "3":
                        Complex raz = InputComplex();
                        num = num.Raz(raz);
                        break;

                    case "4":
                        Complex mul = InputComplex();
                        num = num.Mul(mul);
                        break;

                    case "6":
                        Complex div = InputComplex();
                        num = num.Div(div);
                        break;

                    case "7":
                        Console.WriteLine("Модуль = " + num.Abs());
                        break;

                    case "8":
                        Console.WriteLine("Аргумент (в радианах) = " + num.Arg());
                        break;

                    case "Q":
                        Console.WriteLine("Выход");
                        return;

                    default:
                        Console.WriteLine("Неизвестная команда!");
                        break;
                }
            }
        }

        static Complex InputComplex()
        {
            Console.Write("Введите Re: ");
            double re = double.Parse(Console.ReadLine());
            Console.Write("Введите Im: ");
            double im = double.Parse(Console.ReadLine());
            return new Complex(re, im);
        }
    }
}
