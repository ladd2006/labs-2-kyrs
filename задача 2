using System;

namespace задача_комплексные
{
    class Program
    {
        static void Main()
        {
            Complex num = new Complex(0, 0);

            while (true)
            {
                Console.WriteLine($"число щас: {num}");
                Console.WriteLine("1 новое число ввести");
                Console.WriteLine("2 +");
                Console.WriteLine("3 -");
                Console.WriteLine("4 *");
                Console.WriteLine("5 /");
                Console.WriteLine("6 модуль");
                Console.WriteLine("7 аргумент");
                Console.WriteLine("Q выход");

                string vibor = Console.ReadLine();
                Console.WriteLine();

                switch (vibor)
                {
                    case "1":
                        Console.Write("Re: ");
                        double re = double.Parse(Console.ReadLine());
                        Console.Write("Im: ");
                        double im = double.Parse(Console.ReadLine());
                        num = new Complex(re, im);
                        break;

                    case "2":
                        Complex add = InputComplex();
                        num = num.Add(add);
                        break;

                    case "3":
                        Complex sub = InputComplex();
                        num = num.Subtract(sub);
                        break;

                    case "4":
                        Complex mul = InputComplex();
                        num = num.Multiply(mul);
                        break;

                    case "5":
                        Complex div = InputComplex();
                        num = num.Divide(div);
                        break;

                    case "6":
                        Console.WriteLine($"Модуль: {num.Modulus():F4}");
                        Console.ReadLine();
                        break;

                    case "7":
                        Console.WriteLine($"Аргумент: {num.Argument():F4} рад");
                        Console.ReadLine();
                        break;

                    case "Q":
                    case "q":
                        return;

                    default:
                        Console.WriteLine("Неверная команда");
                        break;
                }

                Console.Clear();
            }
        }

        static Complex InputComplex()
        {
            Console.Write("Введите Re: ");
            double re = double.Parse(Console.ReadLine());
            Console.Write("Введите Im: ");
            double im = double.Parse(Console.ReadLine());
            return new Complex(re, im);
        }
    }
    public class Complex
    {
        public double Re { get; set; }
        public double Im { get; set; }

        public Complex()
        {
            Re = 0;
            Im = 0;
        }

        public Complex(double re, double im)
        {
            Re = re;
            Im = im;
        }

        public Complex Add(Complex other)
        {
            return new Complex(Re + other.Re, Im + other.Im);
        }

        public Complex Subtract(Complex other)
        {
            return new Complex(Re - other.Re, Im - other.Im);
        }

        public Complex Multiply(Complex other)
        {
            double re = Re * other.Re - Im * other.Im;
            double im = Re * other.Im + Im * other.Re;
            return new Complex(re, im);
        }

        public Complex Divide(Complex other)
        {
            double denominator = other.Re * other.Re + other.Im * other.Im;
            double re = (Re * other.Re + Im * other.Im) / denominator;
            double im = (Im * other.Re - Re * other.Im) / denominator;
            return new Complex(re, im);
        }

        public double Modulus()
        {
            return Math.Sqrt(Re * Re + Im * Im);
        }

        public double Argument()
        {
            return Math.Atan2(Im, Re);
        }

        public override string ToString()
        {
            string sign = Im >= 0 ? "+" : "-";
            return $"{Re} {sign} {Math.Abs(Im)}i";
        }
    }
}
