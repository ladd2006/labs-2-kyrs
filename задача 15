using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;
namespace задача_15
{
    internal class Program
    {
        static void Main(string[] args)
        {
            string[] lines = File.ReadAllLines("vhod.txt");
            MyArrrayDeque DEq = new MyArrrayDeque(lines.Length);
            foreach(string line in  lines)
            {
                DEq.opredelenStroka(line);
            }
            string[] vihodMas = new string[DEq.size()];
            for(int i = 0;i <  DEq.size();i++)
            {
                vihodMas[i] = DEq.Get(i);
            }
            File.WriteAllLines("vihod.txt", vihodMas);
            int countDeleteProbel = int.Parse(Console.ReadLine());
            MyArrrayDeque Udalenstrok = new MyArrrayDeque(DEq.size());
            for (int i =0; i < DEq.size();i++)
            {
                if(countProbel(DEq.Get(i)) > countDeleteProbel)
                {
                    Udalenstrok.add(DEq.Get(i));
                }
            }
            for(int i = 0;i < Udalenstrok.size();i++)
            {
                DEq.remove(Udalenstrok.Get(i));
            }
            DEq.PrintMas();

        }
        public static int countProbel(string line)
        {
            int count = 0;
            for(int i = 0;i<line.Length;i++)
            {
                if (line[i] == ' ') count++;

            }
            return count;
        }


        public class MyArrrayDeque
        {
            public string[] elements;
            public int head, tail;

            public MyArrrayDeque()
            {
                elements = new string[16];
                head = 0; tail = -1;
            }
            public MyArrrayDeque(string[] a)
            {
                elements = new string[a.Length];
                Array.Copy(a, elements, a.Length);
                head = 0;
                tail = a.Length - 1;

            }
            public MyArrrayDeque(int numElements)
            {
                elements = new string[numElements];
                head = 0;
                tail = -1;
            }
            
            
            public int CountDig(string stroka)
            {
                
                int count = 0;
                for (int i = 0; i < stroka.Length; i++)
                {
                    if (char.IsDigit(stroka[i])) count++;
                }
                return count;
            }
            public void opredelenStroka(string stroka)
            {
                if (isEmpty())
                {
                    AddFirst(stroka);
                    return;
                }
                string firstStroka = getFirst();
                if (CountDig(stroka) > CountDig(firstStroka))
                {
                    AddLast(stroka);
                }
                else
                {
                    AddFirst(stroka);
                }
            }
            public string Get(int ind)
            {
                return elements[ind];
            }
            public void add(string e)
            {
                if (elements.Length <= size())
                {
                    string[] temp = new string[elements.Length * 2];
                    Array.Copy(elements, temp, elements.Length);
                    elements = temp;
                }
                tail++;
                elements[tail] = e;


            }
            public void addAll(string[] a)
            {
                if (elements.Length < (tail - head + a.Length))
                {
                    string[] temp = new string[elements.Length + a.Length];
                    Array.Copy(elements, temp, elements.Length);
                    elements = temp;
                }
                for (int i = 0; i < a.Length; i++)
                {
                    elements[tail++] = a[i];
                }
                tail += a.Length;
            }
            public bool contains(object o)
            {
                for (int i = 0; i < tail + 1; i++)
                {
                    if (Equals(o, elements[i])) return true;
                }
                return false;
            }
            public bool containsAll(string[] a)
            {
                int count = 0;
                for (int i = 0; i < a.Length; i++)
                {
                    if (contains(a[i])) count++;
                }
                if (count == elements.Length)
                {
                    return true;
                }
                return false;
            }
            public bool isEmpty()
            {
                return tail < head; 
            }
            public void remove(object o)
            {
                for (int i = head; i <= tail; i++)
                {
                    if (Equals(elements[i], o))
                    {

                        for (int j = i; j < tail; j++)
                        {
                            elements[j] = elements[j + 1];
                        }


                        elements[tail] = default(string);
                        tail--;


                        if (tail < head)
                        {
                            head = 0;
                            tail = 0;
                        }

                        break;
                    }
                }
            }
            public void retainAll(string[] a)
            {
                List<string> toRemove = new List<string>();
                bool modified = false;


                for (int i = head; i <= tail; i++)
                {
                    bool found = false;
                    foreach (string item in a)
                    {
                        if (Equals(elements[i], item))
                        {
                            found = true;
                            break;
                        }
                    }

                    if (!found)
                    {
                        toRemove.Add(elements[i]);

                    }
                }


                foreach (string item in toRemove)
                {
                    remove(item);
                }


            }
            public int size()
            {
                if (tail < head) return 0;
                return tail - head + 1;
            }
            public string element()
            {
                return elements[head];
            }
            public bool offer(string obj)
            {
                try
                {
                    add(obj);
                    return true;
                }
                catch (Exception)
                {
                    return false;
                }
            }
            public string peek()
            {
                if (isEmpty())
                {
                    return default(string);
                }
                return elements[head];
            }
            public string poll()
            {

                string res = elements[head];
                remove(elements[head]);
                return res;
            }
            public void AddFirst(string obj)
            {
                if (size() >= elements.Length)
                {
                    string[] temp = new string[size() + 1];
                    Array.Copy(elements, 0, temp, 1, size());
                    elements = temp;
                    tail = size();
                    head = 0;

                }
                else
                {
                    for (int i = tail; i >= head; i--)
                    {
                        elements[i + 1] = elements[i];
                    }
                    tail++;
                }
                elements[head] = obj;
            }
            public void AddLast(string obj)
            {
                add(obj);
            }
            public string getFirst()
            {
                return elements[head];
            }
            public string getLast()
            {
                return elements[tail];
            }
            public bool offerFirst(string obj)
            {
                try
                {
                    AddFirst(obj);
                    return true;
                }
                catch (Exception)
                {
                    return false;
                }
            }
            public bool offerLast(string obj)
            {
                try
                {
                    add(obj);
                    return true;
                }
                catch (Exception)
                {
                    return false;
                }
            }
            public string pop()
            {
                string res = elements[head];
                remove(elements[head]);
                return res;
            }
            public void push(string obj)
            {
                AddFirst(obj);
            }
            public string peekFirst()
            {
                try
                {
                    return elements[head];
                }
                catch (Exception)
                {
                    return default(string);
                }
            }
            public string peekLast()
            {
                try
                {
                    return elements[tail];
                }
                catch (Exception)
                {
                    return default(string);
                }
            }
            public string pollF()
            {
                try
                {
                    return pop();

                }
                catch (Exception)
                {
                    return default(string);
                }
            }
            public string pollL()
            {
                try
                {
                    string res = elements[tail];
                    remove(elements[tail]);
                    return res;
                }
                catch (Exception)
                {
                    return default(string);
                }
            }
            public void removeFirst()
            {
                pop();
            }
            public void removelast()
            {
                pollL();
            }
            public bool removelasOc(object o)
            {

                for (int i = tail; i >= head; i--)
                {
                    if (Equals(elements[i], o))
                    {
                        remove(elements[i]);
                        return true;

                    }
                }
                return false;


            }
            public bool removFirOc(object o)
            {
                for (int i = head; i <= tail; i++)
                {
                    if (Equals(elements[i], o))
                    {
                        remove(elements[i]);
                        return true;

                    }
                }
                return false;
            }
            public void PrintMas()
            {
                for (int i = head; i < size(); i++)
                {
                    Console.WriteLine($"{i + 1}: {elements[i]}");
                }
            }
        }
    }
}
